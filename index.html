<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Homeschool Curriculum Map</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 0 32px 64px rgba(0,0,0,0.2), 0 0 0 1px rgba(255,255,255,0.1);
            overflow: visible;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .header {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #ec4899 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/><circle cx="50" cy="10" r="0.5" fill="white" opacity="0.1"/><circle cx="20" cy="80" r="0.5" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            pointer-events: none;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            font-weight: 800;
            background: linear-gradient(45deg, #ffffff, #f1f5f9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.95;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }

        .nav-tabs {
            display: flex;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-bottom: 1px solid rgba(148, 163, 184, 0.2);
            padding: 8px;
            gap: 4px;
        }

        .nav-tab {
            flex: 1;
            padding: 16px 24px;
            text-align: center;
            background: none;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 12px;
            position: relative;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
        }

        .nav-tab:hover:not(.active) {
            background: rgba(99, 102, 241, 0.1);
            color: #6366f1;
            transform: translateY(-1px);
        }

        .content {
            padding: 30px;
        }

        .view {
            display: none;
        }

        .view.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 0.95rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
            background: rgba(255, 255, 255, 1);
            transform: translateY(-1px);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .btn {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 14px rgba(99, 102, 241, 0.3);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #64748b 0%, #475569 100%);
            box-shadow: 0 4px 14px rgba(100, 116, 139, 0.3);
        }

        .btn-secondary:hover {
            box-shadow: 0 8px 25px rgba(100, 116, 139, 0.4);
        }

        .calendar-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .quarter-btn {
            padding: 10px 20px;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quarter-btn.active {
            background: #4facfe;
            color: white;
            border-color: #4facfe;
        }

        .curriculum-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .curriculum-table th {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: white;
            padding: 18px;
            text-align: left;
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .curriculum-table th .editable {
            background: transparent;
            border: 2px dashed transparent;
            color: white;
            padding: 8px;
            border-radius: 6px;
            min-height: auto;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .curriculum-table th .editable:hover {
            border-color: rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
        }

        .curriculum-table th .editable:focus {
            border-color: rgba(255, 255, 255, 0.6);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
        }

        .curriculum-table th .editable:empty::before {
            content: 'Click to edit header...';
            color: rgba(255, 255, 255, 0.7);
            font-style: italic;
            text-transform: none;
            letter-spacing: normal;
        }

        .curriculum-table td {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
            vertical-align: top;
        }

        .curriculum-table tr:hover {
            background: #f8f9fa;
        }

        .editable {
            background: rgba(248, 250, 252, 0.5);
            border: 2px dashed #cbd5e1;
            padding: 12px;
            border-radius: 8px;
            min-height: 44px;
            cursor: text;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .editable:hover {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.05);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.1);
        }

        .editable:focus {
            outline: none;
            border: 2px solid #6366f1;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
            transform: translateY(-2px);
        }

        .editable:empty::before {
            content: 'Click to edit...';
            color: #94a3b8;
            font-style: italic;
        }

        .notes-section {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .notes-section h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .insights-section {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .insights-section h3 {
            color: #0c5460;
            margin-bottom: 15px;
        }

        .quarter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .week-column {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .week-column h4 {
            color: #495057;
            margin-bottom: 10px;
        }

        .date-range {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 15px;
        }

        .subject-row {
            display: grid;
            grid-template-columns: 150px 150px repeat(10, 1fr);
            gap: 8px;
            align-items: stretch;
            padding: 8px;
            border-bottom: 1px solid #e9ecef;
            background: white;
        }

        .subject-row:first-child {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            font-weight: 600;
            border-radius: 8px 8px 0 0;
            box-shadow: 0 2px 4px rgba(79, 172, 254, 0.3);
        }

        .subject-row:hover:not(:first-child) {
            background: #f8f9fa;
        }

        .subject-cell {
            padding: 12px;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            background: white;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .subject-row:first-child .subject-cell,
        .subject-row:first-child > div {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .calendar-nav {
                flex-direction: column;
                gap: 15px;
            }
            
            .curriculum-table {
                font-size: 0.9rem;
            }
            
            .subject-row {
                grid-template-columns: 1fr;
                gap: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>✨ EduFlow Planner</h1>
            <p>Smart Curriculum Design for Modern Educators</p>
            <div style="margin-top: 20px; display: flex; justify-content: center; gap: 40px; font-size: 1.1rem;">
                <div>
                    <strong>Student:</strong> 
                    <span id="header-student-name" style="cursor: pointer; text-decoration: underline; padding: 4px 8px; border-radius: 6px; transition: background 0.3s;" onclick="editHeaderName('student')">Click to edit</span>
                </div>
                <div>
                    <strong>Teacher/Facilitator:</strong> 
                    <span id="header-teacher-name" style="cursor: pointer; text-decoration: underline; padding: 4px 8px; border-radius: 6px; transition: background 0.3s;" onclick="editHeaderName('teacher')">Click to edit</span>
                </div>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchView('subject')">Subject Curriculum Map</button>
            <button class="nav-tab" id="overview-tab" onclick="switchView('quarter')">Quarterly Overview</button>
        </div>

        <div class="content">
            <!-- Subject Curriculum Map View -->
            <div id="subject-view" class="view active">
                <div class="form-row">
                    <div class="form-group">
                        <label for="subject-name">Subject Name</label>
                        <select id="subject-name">
                            <option value="Mathematics" selected>Mathematics</option>
                            <option value="Language Arts">Language Arts</option>
                            <option value="English">English</option>
                            <option value="Science">Science</option>
                            <option value="History">History</option>
                            <option value="Geography">Geography</option>
                            <option value="Art">Art</option>
                            <option value="Music">Music</option>
                            <option value="Physical Education">Physical Education</option>
                            <option value="Foreign Language">Foreign Language</option>
                            <option value="Life Skills">Life Skills</option>
                            <option value="Bible/Religion">Bible/Religion</option>
                            <option value="Computer Science">Computer Science</option>
                            <option value="Health">Health</option>
                            <option value="Drama/Theater">Drama/Theater</option>
                            <option value="Filipino">Filipino</option>
                            <option value="Araling Panlipunan">Araling Panlipunan</option>
                            <option value="Mother Tongue">Mother Tongue</option>
                            <option value="Values Education">Values Education</option>
                            <option value="MAPEH">MAPEH</option>
                            <option value="TLE">TLE (Technology & Livelihood)</option>
                            <option value="Custom">Custom Subject</option>
                        </select>
                        <input type="text" id="custom-subject" placeholder="Enter custom subject name" style="display: none; margin-top: 10px;">
                    </div>
                    <div class="form-group">
                        <label for="grade-level">Grade Level</label>
                        <select id="grade-level">
                            <option value="Nursery">Nursery</option>
                            <option value="Pre-K">Pre-Kindergarten</option>
                            <option value="K">Kindergarten</option>
                            <option value="1" selected>Grade 1</option>
                            <option value="2">Grade 2</option>
                            <option value="3">Grade 3</option>
                            <option value="4">Grade 4</option>
                            <option value="5">Grade 5</option>
                            <option value="6">Grade 6</option>
                            <option value="7">Grade 7</option>
                            <option value="8">Grade 8</option>
                            <option value="9">Grade 9</option>
                            <option value="10">Grade 10</option>
                            <option value="11">Grade 11</option>
                            <option value="12">Grade 12</option>
                            <option value="Year 1">Year 1 (UK)</option>
                            <option value="Year 2">Year 2 (UK)</option>
                            <option value="Year 3">Year 3 (UK)</option>
                            <option value="Year 4">Year 4 (UK)</option>
                            <option value="Year 5">Year 5 (UK)</option>
                            <option value="Year 6">Year 6 (UK)</option>
                            <option value="Year 7">Year 7 (UK)</option>
                            <option value="Year 8">Year 8 (UK)</option>
                            <option value="Year 9">Year 9 (UK)</option>
                            <option value="Year 10">Year 10 (UK)</option>
                            <option value="Year 11">Year 11 (UK)</option>
                            <option value="Year 12">Year 12 (UK)</option>
                            <option value="Year 13">Year 13 (UK)</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="school-year-start">School Year Start</label>
                        <select id="school-year-start">
                            <option value="january">January (Philippines, Australia)</option>
                            <option value="february">February (Some Asian countries)</option>
                            <option value="march">March (Japan, South Korea)</option>
                            <option value="april">April (India, Thailand)</option>
                            <option value="june">June (Philippines - some schools)</option>
                            <option value="august">August (Europe, some US states)</option>
                            <option value="september" selected>September (US, Canada, UK)</option>
                            <option value="custom">Custom Start Month</option>
                        </select>
                        <input type="month" id="custom-start-month" placeholder="Select custom start month" style="display: none; margin-top: 10px;">
                    </div>
                    <div class="form-group">
                        <label for="calendar-system">Calendar System</label>
                        <select id="calendar-system">
                            <option value="quarters" selected>4 Quarters (10-12 weeks each)</option>
                            <option value="semesters">2 Semesters (18-20 weeks each)</option>
                            <option value="trimesters">3 Trimesters (12-13 weeks each)</option>
                            <option value="terms">4 Terms (8-10 weeks each)</option>
                            <option value="custom">Custom Periods</option>
                        </select>
                    </div>
                </div>

                <div class="calendar-nav">
                    <button class="quarter-btn" onclick="setQuarter('previous')">← Previous Quarter</button>
                    <div>
                        <h3 id="current-quarter">Quarter 1 - September 2025</h3>
                        <p id="quarter-dates">September 1 - November 30, 2025</p>
                    </div>
                    <button class="quarter-btn" onclick="setQuarter('next')">Next Quarter →</button>
                </div>

                <h2 id="subject-title">Mathematics Curriculum Map</h2>

                <table class="curriculum-table">
                    <thead>
                        <tr>
                            <th><div class="editable" contenteditable="true">Time Period</div></th>
                            <th><div class="editable" contenteditable="true">Learning Objectives</div></th>
                            <th><div class="editable" contenteditable="true">Key Concepts & Topics</div></th>
                            <th><div class="editable" contenteditable="true">Skills & Competencies</div></th>
                            <th><div class="editable" contenteditable="true">Assessment Methods</div></th>
                            <th><div class="editable" contenteditable="true">Learning Activities</div></th>
                            <th><div class="editable" contenteditable="true">Resources & Materials</div></th>
                            <th><div class="editable" contenteditable="true">Standards Alignment</div></th>
                        </tr>
                    </thead>
                    <tbody id="curriculum-body">
                        <tr>
                            <td><strong>September</strong></td>
                            <td><div class="editable" contenteditable="true">Students will understand number concepts and develop counting skills from 1-20</div></td>
                            <td><div class="editable" contenteditable="true">Numbers 1-20, Counting sequences, Number recognition, Place value basics</div></td>
                            <td><div class="editable" contenteditable="true">Count accurately, identify numerals, compare quantities, order numbers</div></td>
                            <td><div class="editable" contenteditable="true">Diagnostic assessment, number identification checklist, counting fluency test</div></td>
                            <td><div class="editable" contenteditable="true">Number games, counting songs, manipulative exploration, number line activities</div></td>
                            <td><div class="editable" contenteditable="true">Counting bears, number cards, math manipulatives, interactive whiteboard</div></td>
                            <td><div class="editable" contenteditable="true">Common Core K.CC.1-3, TEKS K.2A-B</div></td>
                        </tr>
                        <tr>
                            <td><strong>October</strong></td>
                            <td><div class="editable" contenteditable="true">Students will understand addition and subtraction concepts within 10</div></td>
                            <td><div class="editable" contenteditable="true">Addition concepts, Subtraction basics, Number bonds, Story problems</div></td>
                            <td><div class="editable" contenteditable="true">Add within 10, subtract within 10, solve word problems, explain thinking</div></td>
                            <td><div class="editable" contenteditable="true">Problem-solving rubric, math journal entries, fact fluency checks</div></td>
                            <td><div class="editable" contenteditable="true">Story problem theater, hands-on addition/subtraction, math centers</div></td>
                            <td><div class="editable" contenteditable="true">Ten frames, counters, story problem cards, math journals</div></td>
                            <td><div class="editable" contenteditable="true">Common Core K.OA.1-2, TEKS K.3A-C</div></td>
                        </tr>
                        <tr>
                            <td><strong>November</strong></td>
                            <td><div class="editable" contenteditable="true">Students will identify, create, and extend patterns using various attributes</div></td>
                            <td><div class="editable" contenteditable="true">AB patterns, ABC patterns, Growing patterns, Shape patterns, Color patterns</div></td>
                            <td><div class="editable" contenteditable="true">Identify patterns, create patterns, extend sequences, describe pattern rules</div></td>
                            <td><div class="editable" contenteditable="true">Pattern creation portfolio, pattern extension tasks, peer assessment</div></td>
                            <td><div class="editable" contenteditable="true">Pattern blocks exploration, movement patterns, art pattern creation</div></td>
                            <td><div class="editable" contenteditable="true">Pattern blocks, colored tiles, music instruments, art supplies</div></td>
                            <td><div class="editable" contenteditable="true">Common Core K.MD.3, TEKS K.7A</div></td>
                        </tr>
                    </tbody>
                </table>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div style="background: #e8f4fd; border: 1px solid #bee5eb; border-radius: 12px; padding: 20px;">
                        <h3 style="color: #0c5460; margin-bottom: 15px;">📋 Prerequisites</h3>
                        <div class="editable" contenteditable="true" style="min-height: 80px;">
                            • Basic number recognition 1-10
                            • Understanding of more/less concepts
                            • Fine motor skills for writing
                            • Ability to follow multi-step directions
                        </div>
                    </div>
                    <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 12px; padding: 20px;">
                        <h3 style="color: #495057; margin-bottom: 15px;">🎯 Unit Learning Goals</h3>
                        <div class="editable" contenteditable="true" style="min-height: 80px;">
                            • Conceptual Understanding
                            • Procedural Fluency
                            • Strategic Competence
                            • Adaptive Reasoning
                            • Productive Disposition
                        </div>
                    </div>
                </div>

                <div class="notes-section">
                    <h3>📝 Teaching Notes</h3>
                    <div class="editable" contenteditable="true" style="min-height: 100px;">
                        • Focus on hands-on learning and concrete manipulatives
                        • Allow extra time for students who need it
                        • Incorporate movement and games into lessons
                        • Connect math to real-world situations
                        • Use visual aids and number lines consistently
                        • Differentiate instruction based on student readiness
                        • Encourage mathematical discourse and reasoning
                    </div>
                </div>

                <div class="insights-section">
                    <h3>💡 Curriculum Mapping Strategy Insights</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                        <div>
                            <div style="padding: 8px 0; border-bottom: 1px solid rgba(12, 84, 96, 0.2);">
                                <strong>🎯 Learning Objectives Alignment:</strong> Ensure objectives match your key concepts and assessment methods
                            </div>
                            <div style="padding: 8px 0; border-bottom: 1px solid rgba(12, 84, 96, 0.2);">
                                <strong>🧠 Skills & Competencies Focus:</strong> Balance conceptual understanding with practical application skills
                            </div>
                            <div style="padding: 8px 0; border-bottom: 1px solid rgba(12, 84, 96, 0.2);">
                                <strong>📊 Assessment-Activity Connection:</strong> Match assessment methods directly to learning activities
                            </div>
                            <div style="padding: 8px 0;">
                                <strong>📚 Resource-Standards Integration:</strong> Align materials and resources with standards requirements
                            </div>
                        </div>
                        <div>
                            <div style="padding: 8px 0; border-bottom: 1px solid rgba(12, 84, 96, 0.2);">
                                <strong>🔗 Cross-Topic Connections:</strong> Link concepts across time periods for deeper understanding
                            </div>
                            <div style="padding: 8px 0; border-bottom: 1px solid rgba(12, 84, 96, 0.2);">
                                <strong>📈 Progressive Complexity:</strong> Build skills systematically from simple to complex applications
                            </div>
                            <div style="padding: 8px 0; border-bottom: 1px solid rgba(12, 84, 96, 0.2);">
                                <strong>🌍 Real-World Applications:</strong> Connect learning activities to authentic, meaningful contexts
                            </div>
                            <div style="padding: 8px 0;">
                                <strong>🔄 Continuous Assessment:</strong> Use multiple assessment methods to track student progress
                            </div>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 30px; display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;">
                    <button class="btn" onclick="exportToPDF()">📄 Export PDF</button>
                    <button class="btn btn-secondary" onclick="printMap()">🖨️ Print</button>
                    <button class="btn btn-secondary" onclick="saveAsTemplate()">💾 Save Template</button>
                    <button class="btn btn-secondary" onclick="duplicateSubject()">📋 Duplicate Subject</button>
                </div>
            </div>

            <!-- Quarter Overview View -->
            <div id="quarter-view" class="view">
                <div class="form-row">
                    <div class="form-group">
                        <label for="quarter-select" id="period-label">Period</label>
                        <select id="quarter-select">
                            <option value="1" selected>Period 1</option>
                            <option value="2">Period 2</option>
                            <option value="3">Period 3</option>
                            <option value="4">Period 4</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="academic-year">Academic Year</label>
                        <input type="text" id="academic-year" placeholder="e.g., 2025-2026" value="2025-2026">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="country-region" id="country-label">Country/Region</label>
                        <select id="country-region">
                            <option value="philippines">Philippines</option>
                            <option value="usa" selected>United States</option>
                            <option value="canada">Canada</option>
                            <option value="uk">United Kingdom</option>
                            <option value="australia">Australia</option>
                            <option value="singapore">Singapore</option>
                            <option value="malaysia">Malaysia</option>
                            <option value="india">India</option>
                            <option value="japan">Japan</option>
                            <option value="south-korea">South Korea</option>
                            <option value="thailand">Thailand</option>
                            <option value="indonesia">Indonesia</option>
                            <option value="vietnam">Vietnam</option>
                            <option value="uae">United Arab Emirates</option>
                            <option value="saudi-arabia">Saudi Arabia</option>
                            <option value="qatar">Qatar</option>
                            <option value="kuwait">Kuwait</option>
                            <option value="bahrain">Bahrain</option>
                            <option value="oman">Oman</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="language-interface" id="language-label">Interface Language</label>
                        <select id="language-interface">
                            <option value="english" selected>English</option>
                            <option value="filipino">Filipino/Tagalog</option>
                            <option value="spanish">Español</option>
                            <option value="french">Français</option>
                            <option value="german">Deutsch</option>
                            <option value="japanese">日本語</option>
                            <option value="korean">한국어</option>
                            <option value="chinese">中文</option>
                            <option value="thai">ไทย</option>
                            <option value="vietnamese">Tiếng Việt</option>
                            <option value="malay">Bahasa Melayu</option>
                            <option value="indonesian">Bahasa Indonesia</option>
                            <option value="arabic">العربية</option>
                            <option value="hindi">हिन्दी</option>
                        </select>
                    </div>
                </div>

                <h2 id="quarter-title">Curriculum Map - Grade 1</h2>
                <h3 id="quarter-subtitle">Quarter 1</h3>

                <div class="subject-row" id="week-headers">
                    <div><strong>Subject</strong></div>
                    <div><strong>Textbook</strong></div>
                    <div><strong>Week 1</strong><br><span class="date-range">Sep 1-5</span></div>
                    <div><strong>Week 2</strong><br><span class="date-range">Sep 8-12</span></div>
                    <div><strong>Week 3</strong><br><span class="date-range">Sep 15-19</span></div>
                    <div><strong>Week 4</strong><br><span class="date-range">Sep 22-26</span></div>
                    <div><strong>Week 5</strong><br><span class="date-range">Oct 1-3</span></div>
                    <div><strong>Week 6</strong><br><span class="date-range">Oct 6-10</span></div>
                    <div><strong>Week 7</strong><br><span class="date-range">Oct 13-17</span></div>
                    <div><strong>Week 8</strong><br><span class="date-range">Oct 20-24</span></div>
                    <div><strong>Week 9</strong><br><span class="date-range">Oct 27-31</span></div>
                    <div><strong>Week 10</strong><br><span class="date-range">Nov 3-7</span></div>
                </div>

                <div id="subject-rows-container">
                    <div class="subject-row">
                        <div class="subject-cell"><strong>Mathematics</strong></div>
                        <div class="subject-cell editable" contenteditable="true">Saxon Math 1</div>
                        <div class="subject-cell editable" contenteditable="true">Numbers 1-10</div>
                        <div class="subject-cell editable" contenteditable="true">Counting to 20</div>
                        <div class="subject-cell editable" contenteditable="true">Number order</div>
                        <div class="subject-cell editable" contenteditable="true">Addition intro</div>
                        <div class="subject-cell editable" contenteditable="true">Addition facts</div>
                        <div class="subject-cell editable" contenteditable="true">Subtraction intro</div>
                        <div class="subject-cell editable" contenteditable="true">Number bonds</div>
                        <div class="subject-cell editable" contenteditable="true">Problem solving</div>
                        <div class="subject-cell editable" contenteditable="true">Patterns</div>
                        <div class="subject-cell editable" contenteditable="true">Review & assess</div>
                    </div>

                    <div class="subject-row">
                        <div class="subject-cell"><strong>Language Arts</strong></div>
                        <div class="subject-cell editable" contenteditable="true">All About Reading 1</div>
                        <div class="subject-cell editable" contenteditable="true">Letter sounds</div>
                        <div class="subject-cell editable" contenteditable="true">Phonics basics</div>
                        <div class="subject-cell editable" contenteditable="true">CVC words</div>
                        <div class="subject-cell editable" contenteditable="true">Sight words</div>
                        <div class="subject-cell editable" contenteditable="true">Reading fluency</div>
                        <div class="subject-cell editable" contenteditable="true">Comprehension</div>
                        <div class="subject-cell editable" contenteditable="true">Writing letters</div>
                        <div class="subject-cell editable" contenteditable="true">Simple sentences</div>
                        <div class="subject-cell editable" contenteditable="true">Story writing</div>
                        <div class="subject-cell editable" contenteditable="true">Reading assessment</div>
                    </div>

                    <div class="subject-row">
                        <div class="subject-cell"><strong>Science</strong></div>
                        <div class="subject-cell editable" contenteditable="true">Apologia Elementary</div>
                        <div class="subject-cell editable" contenteditable="true">Living things</div>
                        <div class="subject-cell editable" contenteditable="true">Plants</div>
                        <div class="subject-cell editable" contenteditable="true">Animals</div>
                        <div class="subject-cell editable" contenteditable="true">Habitats</div>
                        <div class="subject-cell editable" contenteditable="true">Weather</div>
                        <div class="subject-cell editable" contenteditable="true">Seasons</div>
                        <div class="subject-cell editable" contenteditable="true">Earth science</div>
                        <div class="subject-cell editable" contenteditable="true">Experiments</div>
                        <div class="subject-cell editable" contenteditable="true">Nature study</div>
                        <div class="subject-cell editable" contenteditable="true">Science fair prep</div>
                    </div>

                    <div class="subject-row">
                        <div class="subject-cell"><strong>History</strong></div>
                        <div class="subject-cell editable" contenteditable="true">Story of the World 1</div>
                        <div class="subject-cell editable" contenteditable="true">Ancient times</div>
                        <div class="subject-cell editable" contenteditable="true">Early civilizations</div>
                        <div class="subject-cell editable" contenteditable="true">Egypt</div>
                        <div class="subject-cell editable" contenteditable="true">Mesopotamia</div>
                        <div class="subject-cell editable" contenteditable="true">Greece</div>
                        <div class="subject-cell editable" contenteditable="true">Rome</div>
                        <div class="subject-cell editable" contenteditable="true">Timeline work</div>
                        <div class="subject-cell editable" contenteditable="true">Map skills</div>
                        <div class="subject-cell editable" contenteditable="true">Historical figures</div>
                        <div class="subject-cell editable" contenteditable="true">Review project</div>
                    </div>
                </div>

                <div style="margin-top: 20px; display: flex; gap: 15px; flex-wrap: wrap;">
                    <button class="btn" onclick="addSubject()">+ Add Subject</button>
                    <button class="btn btn-secondary" onclick="exportToPDF()">📄 Export PDF</button>
                    <button class="btn btn-secondary" onclick="printMap()">🖨️ Print</button>
                    <button class="btn btn-secondary" onclick="saveAsTemplate()">💾 Save Template</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentQuarter = 1;
        let globalCurrentYear = 2025;

        function switchView(view) {
            // Update nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Update views
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById(view + '-view').classList.add('active');
        }

        function setQuarter(direction) {
            const calendarSystem = document.getElementById('calendar-system').value;
            let maxPeriods = 4;
            
            if (calendarSystem === 'semesters') {
                maxPeriods = 2;
            } else if (calendarSystem === 'trimesters') {
                maxPeriods = 3;
            } else if (calendarSystem === 'terms') {
                maxPeriods = 4;
            }
            
            if (direction === 'next') {
                currentQuarter++;
                if (currentQuarter > maxPeriods) {
                    currentQuarter = 1;
                    globalCurrentYear++;
                }
            } else {
                currentQuarter--;
                if (currentQuarter < 1) {
                    currentQuarter = maxPeriods;
                    globalCurrentYear--;
                }
            }
            updateQuarterDisplay();
        }

        function updateQuarterDisplay() {
            const startMonth = document.getElementById('school-year-start').value;
            const calendarSystem = document.getElementById('calendar-system').value;
            
            // Get the starting month index (0-11)
            const monthMap = {
                'january': 0, 'february': 1, 'march': 2, 'april': 3,
                'may': 4, 'june': 5, 'july': 6, 'august': 7,
                'september': 8, 'october': 9, 'november': 10, 'december': 11
            };
            
            const startMonthIndex = monthMap[startMonth] || 8; // Default to September
            const monthNames = [
                'January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'
            ];
            
            let periods = {};
            let maxPeriods = 4;
            let monthsPerPeriod = 3;
            let periodName = 'Quarter';
            let weeksPerPeriod = 10;
            
            if (calendarSystem === 'semesters') {
                maxPeriods = 2;
                monthsPerPeriod = 6;
                periodName = 'Semester';
                weeksPerPeriod = 18;
            } else if (calendarSystem === 'trimesters') {
                maxPeriods = 3;
                monthsPerPeriod = 4;
                periodName = 'Trimester';
                weeksPerPeriod = 12;
            } else if (calendarSystem === 'terms') {
                maxPeriods = 4;
                monthsPerPeriod = 3;
                periodName = 'Term';
                weeksPerPeriod = 8;
            }
            
            // Update tab name
            document.getElementById('overview-tab').textContent = `${periodName} Overview`;
            
            // Update period selector
            document.getElementById('period-label').textContent = periodName;
            const periodSelect = document.getElementById('quarter-select');
            periodSelect.innerHTML = '';
            for (let i = 1; i <= maxPeriods; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `${periodName} ${i}`;
                if (i === currentQuarter) option.selected = true;
                periodSelect.appendChild(option);
            }
            
            // Generate periods with correct month calculation
            for (let i = 1; i <= maxPeriods; i++) {
                const months = [];
                for (let j = 0; j < monthsPerPeriod; j++) {
                    const monthIndex = (startMonthIndex + (i-1)*monthsPerPeriod + j) % 12;
                    months.push(monthNames[monthIndex]);
                }
                periods[i] = {
                    name: `${periodName} ${i} - ${months[0]}`,
                    dates: `${months[0]} - ${months[monthsPerPeriod-1]}`,
                    months: months,
                    weeks: weeksPerPeriod
                };
            }

            // Adjust current period if it exceeds max periods
            if (currentQuarter > maxPeriods) {
                currentQuarter = 1;
            }

            const period = periods[currentQuarter] || periods[1];
            document.getElementById('current-quarter').textContent = period.name + ' ' + globalCurrentYear;
            document.getElementById('quarter-dates').textContent = period.dates + ', ' + globalCurrentYear;
            document.getElementById('quarter-subtitle').textContent = `${periodName} ${currentQuarter}`;

            // Update curriculum table
            const tbody = document.getElementById('curriculum-body');
            let rows = tbody.querySelectorAll('tr');
            
            const monthsToShow = period.months.length;
            
            // Add or remove rows as needed
            while (rows.length < monthsToShow) {
                const newRow = tbody.insertRow();
                for (let i = 0; i < 8; i++) {
                    const cell = newRow.insertCell();
                    if (i === 0) {
                        cell.innerHTML = '<strong>Month</strong>';
                    } else {
                        cell.innerHTML = '<div class="editable" contenteditable="true">Click to edit...</div>';
                    }
                }
            }
            
            while (rows.length > monthsToShow) {
                tbody.deleteRow(rows.length - 1);
                rows = tbody.querySelectorAll('tr');
            }
            
            // Update month names in curriculum table
            const updatedRows = tbody.querySelectorAll('tr');
            period.months.forEach((monthName, index) => {
                if (updatedRows[index]) {
                    updatedRows[index].cells[0].innerHTML = '<strong>' + monthName + '</strong>';
                }
            });

            // Update navigation buttons
            const prevBtn = document.querySelector('button[onclick="setQuarter(\'previous\')"]');
            const nextBtn = document.querySelector('button[onclick="setQuarter(\'next\')"]');
            
            if (prevBtn) prevBtn.textContent = `← Previous ${periodName}`;
            if (nextBtn) nextBtn.textContent = `Next ${periodName} →`;
            
            // Update overview table headers
            updateOverviewTable(period.weeks, periodName);
        }
        
        function updateOverviewTable(weeksPerPeriod, periodName) {
            const headerRow = document.getElementById('week-headers');
            const subjectRows = document.querySelectorAll('#subject-rows-container .subject-row');
            
            // Calculate week dates
            const startMonth = document.getElementById('school-year-start').value;
            const monthMap = {
                'january': 0, 'february': 1, 'march': 2, 'april': 3,
                'may': 4, 'june': 5, 'july': 6, 'august': 7,
                'september': 8, 'october': 9, 'november': 10, 'december': 11
            };
            const startMonthIndex = monthMap[startMonth] || 8;
            
            const calendarSystem = document.getElementById('calendar-system').value;
            let monthsPerPeriod = 3;
            if (calendarSystem === 'semesters') monthsPerPeriod = 6;
            else if (calendarSystem === 'trimesters') monthsPerPeriod = 4;
            else if (calendarSystem === 'terms') monthsPerPeriod = 3;
            
            const periodStartMonth = (startMonthIndex + (currentQuarter - 1) * monthsPerPeriod) % 12;
            const periodStartDate = new Date(globalCurrentYear, periodStartMonth, 1);
            
            // Clear existing headers
            headerRow.innerHTML = `
                <div><strong>Subject</strong></div>
                <div><strong>Textbook</strong></div>
            `;
            
            // Add week headers with date ranges
            for (let week = 1; week <= weeksPerPeriod; week++) {
                const weekStartDate = new Date(periodStartDate);
                weekStartDate.setDate(weekStartDate.getDate() + (week - 1) * 7);
                
                const weekEndDate = new Date(weekStartDate);
                weekEndDate.setDate(weekEndDate.getDate() + 4);
                
                const startMonth = weekStartDate.toLocaleDateString('en-US', { month: 'short' });
                const startDay = weekStartDate.getDate();
                const endMonth = weekEndDate.toLocaleDateString('en-US', { month: 'short' });
                const endDay = weekEndDate.getDate();
                
                const dateRange = startMonth === endMonth ? 
                    `${startMonth} ${startDay}-${endDay}` : 
                    `${startMonth} ${startDay}-${endMonth} ${endDay}`;
                
                const weekDiv = document.createElement('div');
                weekDiv.innerHTML = `<strong>Week ${week}</strong><br><span class="date-range">${dateRange}</span>`;
                headerRow.appendChild(weekDiv);
            }
            
            // Update subject rows
            subjectRows.forEach(row => {
                const subjectCell = row.children[0].cloneNode(true);
                const textbookCell = row.children[1].cloneNode(true);
                
                const existingContent = [];
                for (let i = 2; i < row.children.length; i++) {
                    existingContent.push(row.children[i].textContent);
                }
                
                row.innerHTML = '';
                row.appendChild(subjectCell);
                row.appendChild(textbookCell);
                
                for (let week = 1; week <= weeksPerPeriod; week++) {
                    const weekCell = document.createElement('div');
                    weekCell.className = 'subject-cell editable';
                    weekCell.contentEditable = 'true';
                    weekCell.textContent = existingContent[week - 1] || `Week ${week} content`;
                    row.appendChild(weekCell);
                }
            });
            
            // Update CSS grid
            const existingStyles = document.querySelectorAll('style[data-grid-style]');
            existingStyles.forEach(style => style.remove());
            
            const style = document.createElement('style');
            style.setAttribute('data-grid-style', 'true');
            style.textContent = `
                .subject-row {
                    grid-template-columns: 150px 150px repeat(${weeksPerPeriod}, 1fr) !important;
                }
            `;
            document.head.appendChild(style);
        }

        function addSubject() {
            const container = document.querySelector('#quarter-view');
            const lastRow = container.querySelector('.subject-row:last-of-type');
            
            const newRow = document.createElement('div');
            newRow.className = 'subject-row';
            newRow.innerHTML = `
                <div class="subject-cell editable" contenteditable="true"><strong>New Subject</strong></div>
                <div class="subject-cell editable" contenteditable="true">Textbook name</div>
                <div class="subject-cell editable" contenteditable="true">Week 1 content</div>
                <div class="subject-cell editable" contenteditable="true">Week 2 content</div>
                <div class="subject-cell editable" contenteditable="true">Week 3 content</div>
                <div class="subject-cell editable" contenteditable="true">Week 4 content</div>
                <div class="subject-cell editable" contenteditable="true">Week 5 content</div>
                <div class="subject-cell editable" contenteditable="true">Week 6 content</div>
                <div class="subject-cell editable" contenteditable="true">Week 7 content</div>
                <div class="subject-cell editable" contenteditable="true">Week 8 content</div>
                <div class="subject-cell editable" contenteditable="true">Week 9 content</div>
                <div class="subject-cell editable" contenteditable="true">Week 10 content</div>
            `;
            
            lastRow.insertAdjacentElement('afterend', newRow);
        }

        // Subject content templates - optimized for performance
        const subjectTemplates = {
            'Mathematics': {
                '1': {
                    months: [
                        {
                            objectives: 'Students will understand number concepts and develop counting skills from 1-20',
                            content: 'Numbers 1-20, Counting sequences, Number recognition, Place value basics',
                            skills: 'Count accurately, identify numerals, compare quantities, order numbers',
                            assessment: 'Diagnostic assessment, number identification checklist, counting fluency test',
                            activities: 'Number games, counting songs, manipulative exploration, number line activities',
                            resources: 'Counting bears, number cards, math manipulatives, interactive whiteboard',
                            standards: 'Common Core 1.NBT.1, TEKS 1.2A-B'
                        },
                        {
                            objectives: 'Students will understand addition and subtraction concepts within 10',
                            content: 'Addition concepts, Subtraction basics, Number bonds, Story problems',
                            skills: 'Add within 10, subtract within 10, solve word problems, explain thinking',
                            assessment: 'Problem-solving rubric, math journal entries, fact fluency checks',
                            activities: 'Story problem theater, hands-on addition/subtraction, math centers',
                            resources: 'Ten frames, counters, story problem cards, math journals',
                            standards: 'Common Core 1.OA.1-2, TEKS 1.3A-C'
                        },
                        {
                            objectives: 'Students will identify, create, and extend patterns using various attributes',
                            content: 'AB patterns, ABC patterns, Growing patterns, Shape patterns, Color patterns',
                            skills: 'Identify patterns, create patterns, extend sequences, describe pattern rules',
                            assessment: 'Pattern creation portfolio, pattern extension tasks, peer assessment',
                            activities: 'Pattern blocks exploration, movement patterns, art pattern creation',
                            resources: 'Pattern blocks, colored tiles, music instruments, art supplies',
                            standards: 'Common Core 1.OA.5, TEKS 1.5A'
                        }
                    ]
                }
            },
            'Language Arts': {
                '1': {
                    months: [
                        {
                            objectives: 'Students will decode words using phonics skills and read with fluency',
                            content: 'Phonics patterns, Word families, Reading fluency, Comprehension strategies',
                            skills: 'Decode unfamiliar words, read with expression, understand main ideas',
                            assessment: 'Phonics assessments, fluency checks, comprehension questions',
                            activities: 'Guided reading, phonics games, fluency practice, book discussions',
                            resources: 'Leveled readers, phonics materials, fluency passages, comprehension worksheets',
                            standards: 'Common Core 1.RF.2-4, TEKS 1.2A-E'
                        },
                        {
                            objectives: 'Students will write complete sentences and short stories with proper conventions',
                            content: 'Sentence structure, Capitalization, Punctuation, Story writing',
                            skills: 'Write complete sentences, use proper capitalization and punctuation, organize ideas',
                            assessment: 'Writing samples, grammar assessments, story evaluations',
                            activities: 'Daily writing, grammar practice, story creation, peer sharing',
                            resources: 'Writing journals, grammar charts, story templates, editing checklists',
                            standards: 'Common Core 1.W.1-3, TEKS 1.11A-D'
                        },
                        {
                            objectives: 'Students will analyze characters and events in stories and make connections',
                            content: 'Character analysis, Plot events, Making connections, Comparing texts',
                            skills: 'Describe characters, sequence events, make text connections, compare stories',
                            assessment: 'Character maps, story sequence activities, connection journals',
                            activities: 'Character studies, story mapping, text-to-self connections, book comparisons',
                            resources: 'Graphic organizers, comparison charts, connection templates, diverse literature',
                            standards: 'Common Core 1.RL.1-7, TEKS 1.6A-H'
                        }
                    ]
                }
            },
            'Science': {
                '1': {
                    months: [
                        {
                            objectives: 'Students will investigate light and sound as forms of energy',
                            content: 'Light sources, Sound sources, Properties of light and sound, Energy concepts',
                            skills: 'Identify sources, describe properties, investigate effects, make observations',
                            assessment: 'Light and sound investigations, property descriptions, source identification',
                            activities: 'Shadow experiments, sound investigations, light source exploration',
                            resources: 'Flashlights, mirrors, musical instruments, shadow materials',
                            standards: 'NGSS 1-PS4-1, TEKS 1.6A-B'
                        },
                        {
                            objectives: 'Students will understand how plants and animals meet their needs in their habitats',
                            content: 'Animal habitats, Plant needs, Adaptations, Survival strategies',
                            skills: 'Describe habitats, explain adaptations, connect needs to environment',
                            assessment: 'Habitat matching, adaptation explanations, survival strategy discussions',
                            activities: 'Habitat dioramas, adaptation research, animal behavior studies',
                            resources: 'Habitat pictures, animal models, research materials, craft supplies',
                            standards: 'NGSS 1-LS1-1, TEKS 1.9A-C'
                        },
                        {
                            objectives: 'Students will observe and predict patterns in the natural world',
                            content: 'Seasonal patterns, Day/night cycles, Moon phases, Natural patterns',
                            skills: 'Observe patterns, make predictions, record observations, identify cycles',
                            assessment: 'Pattern journals, prediction activities, cycle identification',
                            activities: 'Sky observations, seasonal tracking, pattern investigations',
                            resources: 'Observation charts, calendars, moon phase cards, pattern materials',
                            standards: 'NGSS 1-ESS1-1, TEKS 1.8A-C'
                        }
                    ]
                }
            }
        };

        // Handle custom subject input and dynamic content loading
        document.getElementById('subject-name').addEventListener('change', function() {
            const customInput = document.getElementById('custom-subject');
            if (this.value === 'Custom') {
                customInput.style.display = 'block';
                customInput.focus();
            } else {
                customInput.style.display = 'none';
                document.getElementById('subject-title').textContent = this.value + ' Curriculum Map';
                // Use setTimeout to prevent blocking
                setTimeout(() => loadSubjectContent(this.value), 10);
            }
        });

        function loadSubjectContent(subject) {
            console.log('🔄 Loading content for:', subject);
            
            const gradeLevel = document.getElementById('grade-level').value;
            const tbody = document.getElementById('curriculum-body');
            
            if (!tbody) {
                console.error('❌ Curriculum body not found!');
                return;
            }
            
            // Clear existing content
            tbody.innerHTML = '';
            
            // Get template data - simplified lookup
            const template = subjectTemplates[subject];
            const gradeTemplate = template && template[gradeLevel] ? template[gradeLevel] : null;
            
            if (!gradeTemplate || !gradeTemplate.months) {
                console.log('⚠️ Using default content for:', subject);
                loadDefaultContent(subject, gradeLevel);
                return;
            }
            
            // Get calendar settings
            const calendarSystem = document.getElementById('calendar-system').value;
            let monthsNeeded = 3;
            if (calendarSystem === 'semesters') monthsNeeded = 6;
            else if (calendarSystem === 'trimesters') monthsNeeded = 4;
            
            // Calculate period months
            const periodMonths = calculatePeriodMonths(monthsNeeded);
            
            // Create rows efficiently
            const monthsToShow = Math.min(monthsNeeded, gradeTemplate.months.length);
            
            for (let i = 0; i < monthsToShow; i++) {
                const newRow = tbody.insertRow();
                const monthData = gradeTemplate.months[i] || {};
                
                // Month name cell
                newRow.insertCell().innerHTML = '<strong>' + periodMonths[i] + '</strong>';
                
                // Content cells
                const cellContents = [
                    monthData.objectives || `Students will develop ${subject.toLowerCase()} skills`,
                    monthData.content || `Core ${subject.toLowerCase()} concepts`,
                    monthData.skills || 'Essential skills and competencies',
                    monthData.assessment || 'Assessments and evaluations',
                    monthData.activities || 'Learning activities and projects',
                    monthData.resources || 'Materials and resources',
                    monthData.standards || 'Curriculum standards'
                ];
                
                cellContents.forEach(content => {
                    const cell = newRow.insertCell();
                    cell.innerHTML = '<div class="editable" contenteditable="true">' + content + '</div>';
                });
            }
            
            console.log('✅ Template loaded successfully!');
        }
        
        function calculatePeriodMonths(monthsNeeded) {
            const startMonth = document.getElementById('school-year-start').value;
            const monthMap = {
                'january': 0, 'february': 1, 'march': 2, 'april': 3,
                'may': 4, 'june': 5, 'july': 6, 'august': 7,
                'september': 8, 'october': 9, 'november': 10, 'december': 11
            };
            const startMonthIndex = monthMap[startMonth] || 8;
            const monthNames = [
                'January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'
            ];
            
            const calendarSystem = document.getElementById('calendar-system').value;
            let monthsPerPeriod = 3;
            if (calendarSystem === 'semesters') monthsPerPeriod = 6;
            else if (calendarSystem === 'trimesters') monthsPerPeriod = 4;
            
            const periodMonths = [];
            for (let i = 0; i < monthsNeeded; i++) {
                const monthIndex = (startMonthIndex + (currentQuarter - 1) * monthsPerPeriod + i) % 12;
                periodMonths.push(monthNames[monthIndex]);
            }
            
            return periodMonths;
        }
        
        function loadDefaultContent(subject, gradeLevel) {
            console.log('🔧 Loading default content for:', subject);
            
            const tbody = document.getElementById('curriculum-body');
            const calendarSystem = document.getElementById('calendar-system').value;
            
            let monthsNeeded = 3;
            if (calendarSystem === 'semesters') monthsNeeded = 6;
            else if (calendarSystem === 'trimesters') monthsNeeded = 4;
            
            const periodMonths = calculatePeriodMonths(monthsNeeded);
            
            // Create default rows
            for (let i = 0; i < monthsNeeded; i++) {
                const newRow = tbody.insertRow();
                
                // Month name cell
                newRow.insertCell().innerHTML = '<strong>' + periodMonths[i] + '</strong>';
                
                // Default content
                const defaultContents = [
                    `Students will develop ${subject.toLowerCase()} skills for Grade ${gradeLevel}`,
                    `Core ${subject.toLowerCase()} concepts and knowledge`,
                    `Essential skills and competencies`,
                    `Assessments and evaluations`,
                    `Interactive activities and projects`,
                    `Materials and digital resources`,
                    `Grade ${gradeLevel} curriculum standards`
                ];
                
                defaultContents.forEach(content => {
                    const cell = newRow.insertCell();
                    cell.innerHTML = '<div class="editable" contenteditable="true">' + content + '</div>';
                });
            }
            
            console.log('✅ Default content loaded!');
        }

        // Update display when calendar system changes
        document.getElementById('calendar-system').addEventListener('change', updateQuarterDisplay);

        // Handle custom start month
        document.getElementById('custom-start-month').addEventListener('change', function() {
            if (this.value) {
                const date = new Date(this.value + '-01');
                const monthNames = [
                    'january', 'february', 'march', 'april', 'may', 'june',
                    'july', 'august', 'september', 'october', 'november', 'december'
                ];
                const monthName = monthNames[date.getMonth()];
                document.getElementById('school-year-start').value = monthName;
                updateQuarterDisplay();
            }
        });

        // Update subject title when custom subject name changes
        document.getElementById('custom-subject').addEventListener('input', function() {
            if (this.value.trim()) {
                document.getElementById('subject-title').textContent = this.value + ' Curriculum Map';
            }
        });

        // Update content when grade level changes
        document.getElementById('grade-level').addEventListener('change', function() {
            const currentSubject = document.getElementById('subject-name').value;
            if (currentSubject && currentSubject !== 'Custom') {
                console.log('Grade changed, reloading subject content for:', currentSubject);
                setTimeout(() => loadSubjectContent(currentSubject), 10);
            }
            
            // Update quarter title
            const studentName = document.getElementById('header-student-name').textContent;
            const displayName = studentName === 'Click to edit' ? '' : studentName;
            document.getElementById('quarter-title').textContent = 'Curriculum Map - Grade ' + this.value + (displayName ? ' - ' + displayName : '');
        });

        // Header name editing function
        function editHeaderName(type) {
            const element = document.getElementById(`header-${type}-name`);
            const currentText = element.textContent === 'Click to edit' ? '' : element.textContent;
            const promptText = type === 'student' ? 'Enter student name:' : 'Enter educator/teacher name:';
            const newName = prompt(promptText, currentText);
            
            if (newName !== null) {
                element.textContent = newName || 'Click to edit';
                
                if (type === 'student') {
                    // Update quarter title
                    const grade = document.getElementById('grade-level').value;
                    document.getElementById('quarter-title').textContent = 'Curriculum Map - Grade ' + grade + (newName ? ' - ' + newName : '');
                }
            }
        }

        // Export and utility functions
        function exportToPDF() {
            alert('📄 PDF export feature! In the full version, this would generate a professional PDF download.');
        }

        function printMap() {
            window.print();
        }

        function saveAsTemplate() {
            const templateName = prompt('Enter template name:');
            if (templateName) {
                alert('✅ Template "' + templateName + '" saved successfully!');
            }
        }

        function duplicateSubject() {
            const currentSubject = document.getElementById('subject-name').value;
            const newSubject = prompt('Enter name for duplicated subject:', currentSubject + ' - Copy');
            if (newSubject) {
                alert('📋 Subject duplicated! This would create a new curriculum map for "' + newSubject + '"');
            }
        }

        // Set automatic academic year
        function setAutomaticAcademicYear() {
            const now = new Date();
            const currentYear = now.getFullYear();
            const currentMonth = now.getMonth();
            
            const startMonth = document.getElementById('school-year-start').value;
            const monthMap = {
                'january': 0, 'february': 1, 'march': 2, 'april': 3,
                'may': 4, 'june': 5, 'july': 6, 'august': 7,
                'september': 8, 'october': 9, 'november': 10, 'december': 11
            };
            
            const startMonthIndex = monthMap[startMonth] || 8;
            
            let academicStartYear, academicEndYear;
            
            if (currentYear === 2024 && currentMonth < 8) {
                academicStartYear = 2025;
                academicEndYear = 2026;
            } else if (currentYear === 2024 && currentMonth >= 8) {
                academicStartYear = 2025;
                academicEndYear = 2026;
            } else {
                if (currentMonth < startMonthIndex) {
                    academicStartYear = currentYear;
                    academicEndYear = currentYear + 1;
                } else {
                    academicStartYear = currentYear;
                    academicEndYear = currentYear + 1;
                }
            }
            
            const academicYear = `${academicStartYear}-${academicEndYear}`;
            document.getElementById('academic-year').value = academicYear;
            globalCurrentYear = academicStartYear;
        }

        // Update academic year when school start changes
        document.getElementById('school-year-start').addEventListener('change', function() {
            setAutomaticAcademicYear();
            const customInput = document.getElementById('custom-start-month');
            if (this.value === 'custom') {
                customInput.style.display = 'block';
                customInput.focus();
            } else {
                customInput.style.display = 'none';
                updateQuarterDisplay();
            }
        });

        // Initialize
        window.addEventListener('load', () => {
            console.log('🚀 Page loaded - Initializing...');
            setAutomaticAcademicYear();
            updateQuarterDisplay();
            
            // Load initial subject content
            setTimeout(() => {
                const initialSubject = document.getElementById('subject-name').value;
                console.log('🎯 Loading initial subject:', initialSubject);
                loadSubjectContent(initialSubject);
            }, 100);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96e8684d23eaee58',t:'MTc1NTA5MDE1Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
